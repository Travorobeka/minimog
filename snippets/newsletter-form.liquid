{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}

{% comment %}
  Accepts:
  - style: {String} Accepted value: bordered/minimal (optional)
  - button_style: {String} Button style (optional)
  - button_type: {String} Accepted value: text/icon (optional)
  - has_icon: {Boolean} Show letter icon (optional)
  - show_agreement: {Boolean} (optional)
  - agree_text: {String} (optional)
  - placeholder: {String} (optional)
  - button_label: {String} (optional)
  - extra_classes: {String} Extra classes (optional)

  Usage:
  {% render 'newsletter-form',
    style: 'bordered'
    button_type: 'text'
    show_agreement: true
    agree_text: ''
  %}
{% endcomment %}

{% liquid
  assign formId = 'ContactSubscribe-' | append: custom_id
  assign button_type = button_type | default: 'text'
  assign button_style = button_style | default: 'm-button--blank'
  assign button_icon = button_icon | default: 'arrow'
%}

<div class="m-newsletter-form m-newsletter-form--{{ style | default: 'bordered' }} {{ extra_classes }}">
  {% form 'customer', id: formId %}
    {%- capture success_message -%}
      {{ 'general.newsletter_form.confirmation' | t }}
    {%- endcapture -%}
    {% render 'form__error', form: form %}
    {% render 'form__success', form: form, success_message: success_message %}
    <input type="hidden" name="contact[tags]" value="newsletter">
    <div class="m-newsletter-form__wrapper{% if style == 'bordered' %} m-newsletter-form__button-{{ button_position | default: 'inline' }}{% endif %}">
      <div class="m-newsletter-form__input-wrapper m:display-flex m:w-full m:relative">
        {% if has_icon %}
          <span class="m-newsletter-form__icon">
            <svg
              class="m-svg-icon"
              fill="currentColor"
              stroke="currentColor"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 512 512"
            >
              <path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"></path>
            </svg>
          </span>
        {% endif %}
        <input
          type="email"
          name="contact[email]"
          id="{{ formId }}-email"
          value="{% if customer.email != blank %}{{ customer.email }}{% endif %}"
          placeholder="{{ placeholder }}"
          autocorrect="off"
          autocapitalize="off"
          autocomplete="off"
          spellcheck="false"
          class="form-field m-newsletter-form__input{% if has_icon %} form-field--input__icon{% endif %}{% if button_position == 'inside' %} m-newsletter-form__input--inside{% endif %}"
          style="font-size: {{ placeholder_font_size | default: 14 }}px; font-weight: {{ placeholder_font_weight | default: 'normal' }};{% if placeholder_text_color != blank %} color: {{ placeholder_text_color }};{% endif %}"
        >
        {% if button_position == 'inside' %}
          <button
            type="submit"
            name="commit"
            class="m-newsletter-form__button m-newsletter-form__button--inside m-newsletter-form__button--{{ button_type }} m-button {{ button_style }}"
            aria-label="{{ button_label | default: 'Subscribe' }}"
          >
            {% if button_type == 'icon' %}
              {% render 'newsletter-icon', icon: button_icon %}
            {% else %}
              <span>{{ button_label | default: 'Subscribe' }}</span>
            {% endif %}
          </button>
        {% endif %}
      </div>
      {% unless button_position == 'inside' %}
        <button
          type="submit"
          name="commit"
          class="m-newsletter-form__button m-newsletter-form__button--{{ button_type }} m-button {{ button_style }}"
          aria-label="{{ button_label | default: 'Subscribe' }}"
        >
          {% if button_type == 'icon' %}
            {% render 'newsletter-icon', icon: button_icon %}
          {% else %}
            <span>{{ button_label | default: 'Subscribe' }}</span>
          {% endif %}
        </button>
      {% endunless %}
    </div>
    {% if show_agreement and agree_text %}
      <div class="m-newsletter-form__agreement-text" 
           style="margin-top: {{ terms_spacing | default: 12 }}px; font-size: {{ terms_font_size | default: 12 }}px !important; font-weight: {{ terms_font_weight | default: 'normal' }}; color: {{ terms_text_color | default: 'rgb(var(--color-foreground-secondary))' }}; line-height: {{ terms_line_height | default: 1.4 }}; width: 100%; padding: 0; box-sizing: border-box;">
        <div class="m-terms-conditons" style="display: flex; align-items: center; justify-content: center; gap: 8px; width: 100%; box-sizing: border-box;">
          <label class="form-field--checkbox" style="display: flex; align-items: center; gap: 8px; width: 100%; cursor: pointer; box-sizing: border-box;">
            <input type="checkbox" name="agree_terms" value="yes" required style="width: {{ terms_font_size | default: 12 | times: 1.2 }}px; height: {{ terms_font_size | default: 12 | times: 1.2 }}px; margin: 0; flex-shrink: 0; cursor: pointer;">
            <span class="form-field--checkbox__label" style="flex: 1; text-align: left; word-wrap: break-word; overflow-wrap: break-word; hyphens: auto; width: 100%; max-width: 100%; box-sizing: border-box; font-size: {{ terms_font_size | default: 12 }}px !important; font-weight: {{ terms_font_weight | default: 'normal' }} !important; color: {{ terms_text_color | default: 'rgb(var(--color-foreground-secondary))' }} !important; line-height: {{ terms_line_height | default: 1.4 }} !important;">{{ agree_text }}</span>
            <span class="form-field--checkbox__icon" style="width: {{ terms_font_size | default: 12 | times: 1.2 }}px; height: {{ terms_font_size | default: 12 | times: 1.2 }}px; flex-shrink: 0;">
              <svg
                class="m-svg-icon--medium"
                xmlns="http://www.w3.org/2000/svg"
                aria-hidden="true"
                focusable="false"
                fill="none"
                viewBox="0 0 20 20"
                style="width: 100%; height: 100%;"
              >
                <path d="M18.5 1.5H1.5L1.5 18.5H18.5V1.5ZM1.5 0.5C0.947715 0.5 0.5 0.947715 0.5 1.5V18.5C0.5 19.0523 0.947715 19.5 1.5 19.5H18.5C19.0523 19.5 19.5 19.0523 19.5 18.5V1.5C19.5 0.947715 19.0523 0.5 18.5 0.5H1.5Z" fill-rule="evenodd" fill="currentColor"/>
                <path d="M14.9975 6.09084C15.201 6.27746 15.2147 6.59375 15.0281 6.79728L8.91631 13.4627C8.82231 13.5652 8.68987 13.6239 8.55079 13.6247C8.41172 13.6256 8.27857 13.5684 8.18335 13.4671L4.99513 10.0731C4.80606 9.87179 4.81596 9.55536 5.01723 9.3663C5.21849 9.17723 5.53492 9.18713 5.72399 9.3884L8.54335 12.3897L14.291 6.12145C14.4776 5.91791 14.7939 5.90421 14.9975 6.09084Z" fill="currentColor"/>
              </svg>
            </span>
          </label>
        </div>
      </div>
    {% endif %}
  {% endform %}
</div>
