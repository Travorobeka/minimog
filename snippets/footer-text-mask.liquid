{% comment %}
  Footer Text Mask Section
  Displays text with an image mask effect between footer blocks and footer bottom
{% endcomment %}

{% liquid
  assign animation_effect = settings.animations
  assign animated = false
  if animation_effect != 'none'
    assign animated = true
  endif
%}

<div class="m-footer--text-mask m-gradient m-color-{{ section.settings.color_scheme }}" style="padding: 40px 0; display: block; width: 100%; box-sizing: border-box;">
  <div class="{{ container }}" style="width: 100%; max-width: none; padding-left: 15px; padding-right: 15px; box-sizing: border-box;">
    <div class="m-text-mask-wrapper"
         style="text-align: {{ alignment | default: 'center' }}; position: relative; width: 100%; overflow: visible;">
      
      <h2 class="m-text-mask" 
          style="
            font-size: {{ font_size | default: 72 }}px;
            font-weight: {{ font_weight | default: '900' }};
            text-transform: uppercase;
            letter-spacing: 2px;
            line-height: 0.9;
            margin: 0;
            padding: 0;
            width: 100%;
            word-wrap: break-word;
            hyphens: auto;
            {% if mask_image %}
              background-image: url('{{ mask_image | image_url }}');
              background-size: cover;
              background-position: center;
              background-repeat: no-repeat;
              background-clip: text;
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
              color: transparent;
            {% else %}
              background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
              background-size: 400% 400%;
              background-clip: text;
              -webkit-background-clip: text;
              -webkit-text-fill-color: transparent;
              color: transparent;
              animation: gradientShift 8s ease-in-out infinite;
            {% endif %}
          ">
        {{ text_content }}
      </h2>
      
      <!-- Fallback for browsers that don't support background-clip: text -->
      <h2 class="m-text-mask-fallback"
          style="
            font-size: {{ font_size | default: 72 }}px;
            font-weight: {{ font_weight | default: '900' }};
            text-transform: uppercase;
            letter-spacing: 2px;
            line-height: 0.9;
            margin: 0;
            padding: 0;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            z-index: -1;
            color: rgb(var(--color-foreground));
            opacity: 0.2;
            width: 100%;
            word-wrap: break-word;
            hyphens: auto;
          ">
        {{ text_content }}
      </h2>
    </div>
  </div>
</div>

<style>
  .m-footer--text-mask {
    border-top: 1px solid rgba(var(--color-border), 0.2);
    width: 100%;
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .m-text-mask-wrapper {
    position: relative;
    overflow: visible;
    width: 100%;
    min-height: 1px;
  }

  .m-text-mask {
    position: relative;
    z-index: 2;
    display: block !important;
    visibility: visible !important;
  }

  .m-text-mask-fallback {
    display: block;
  }

  /* Animated gradient fallback */
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  /* Tablet responsive */
  @media screen and (max-width: 1024px) and (min-width: 768px) {
    .m-footer--text-mask {
      padding: 32px 0;
    }
    
    .m-text-mask,
    .m-text-mask-fallback {
      font-size: {{ font_size | default: 72 | times: 0.8 }}px !important;
      letter-spacing: 1.5px !important;
    }
  }

  /* Mobile responsive */
  @media screen and (max-width: 767px) {
    .m-footer--text-mask {
      padding: 20px 0 !important;
      display: block !important;
    }
    
    .m-footer--text-mask .{{ container }} {
      padding-left: 20px !important;
      padding-right: 20px !important;
    }
    
    .m-text-mask,
    .m-text-mask-fallback {
      font-size: {{ mobile_font_size | default: 36 }}px !important;
      letter-spacing: 1px !important;
      line-height: 1.1 !important;
      word-break: break-word !important;
      overflow-wrap: break-word !important;
      hyphens: auto !important;
    }

    .m-text-mask-wrapper {
      padding: 0 !important;
      margin: 0 !important;
    }
  }

  /* Extra small mobile */
  @media screen and (max-width: 480px) {
    .m-text-mask,
    .m-text-mask-fallback {
      font-size: {{ mobile_font_size | default: 36 | times: 0.85 }}px !important;
      letter-spacing: 0.5px !important;
    }
  }

  /* Browser support detection */
  @supports not (-webkit-background-clip: text) {
    .m-text-mask {
      display: none !important;
    }
    .m-text-mask-fallback {
      position: static !important;
      z-index: 1 !important;
      opacity: 1 !important;
      display: block !important;
    }
  }

  @supports (-webkit-background-clip: text) {
    .m-text-mask-fallback {
      display: none !important;
    }
  }

  /* Force visibility on all devices */
  @media screen {
    .m-footer--text-mask {
      display: block !important;
      visibility: visible !important;
    }
  }
</style>